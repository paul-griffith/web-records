<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Veterinary SOAP Note Generator</title>
  <link rel="stylesheet" href="css/style.css">
  <meta name="description" content="Generate veterinary SOAP notes from audio recordings using AI transcription">

  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" href="/icon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="icon.png">

  <link rel="manifest" href="site.webmanifest">
  <meta name="theme-color" content="#2c5f7c">
</head>

<body>
  <div id="app" class="container">
    <!-- Header -->
    <header class="header">
      <h1>Veterinary SOAP Note Generator</h1>
      <button id="settings-btn" class="btn-icon" title="Settings" aria-label="Open settings">
        ⚙️
      </button>
    </header>

    <!-- Alert/Error Messages -->
    <div id="alert-container" class="alert-container hidden"></div>

    <!-- Step 1: Audio Recording -->
    <section id="step-recording" class="card">
      <h2>Step 1: Record Consultation</h2>
      <div class="recording-controls">
        <button id="start-recording-btn" class="btn btn-primary">
          Start Recording
        </button>
        <button id="stop-recording-btn" class="btn btn-danger hidden">
          Stop Recording
        </button>
      </div>
      <div id="recording-status" class="status-display hidden">
        <div class="status-indicator recording"></div>
        <span id="recording-timer">00:00</span>
      </div>
      <div id="recording-info" class="info-text">
        Click "Start Recording" to begin capturing audio from your microphone.
      </div>
    </section>

    <!-- Step 2: Transcript Review -->
    <section id="step-transcript" class="card hidden">
      <h2>Step 2: Review Transcript</h2>
      <div id="transcript-loading" class="loading hidden">
        <div class="spinner"></div>
        <p>Transcribing audio...</p>
      </div>
      <div id="transcript-content" class="hidden">
        <textarea
          id="transcript-text"
          class="transcript-editor"
          placeholder="Transcript will appear here..."
          rows="12"
        ></textarea>
        <div class="button-group">
          <button id="rerecord-btn" class="btn btn-secondary">
            Re-record
          </button>
          <button id="generate-soap-btn" class="btn btn-primary">
            Generate SOAP Note
          </button>
        </div>
      </div>
    </section>

    <!-- Step 3: SOAP Note -->
    <section id="step-soap" class="card hidden">
      <h2>Step 3: SOAP Note</h2>
      <div id="soap-loading" class="loading hidden">
        <div class="spinner"></div>
        <p>Generating SOAP note...</p>
      </div>
      <div id="soap-content" class="hidden">
        <!-- Formatting Toolbar -->
        <div id="soap-toolbar" class="editor-toolbar">
          <div class="toolbar-group">
            <button type="button" class="toolbar-btn" data-command="bold" title="Bold (Ctrl+B)">
              <strong>B</strong>
            </button>
            <button type="button" class="toolbar-btn" data-command="italic" title="Italic (Ctrl+I)">
              <em>I</em>
            </button>
            <button type="button" class="toolbar-btn" data-command="underline" title="Underline (Ctrl+U)">
              <u>U</u>
            </button>
          </div>
          <div class="toolbar-separator"></div>
          <div class="toolbar-group">
            <button type="button" class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List">
              • List
            </button>
            <button type="button" class="toolbar-btn" data-command="insertOrderedList" title="Numbered List">
              1. List
            </button>
          </div>
          <div class="toolbar-separator"></div>
          <div class="toolbar-group">
            <button type="button" class="toolbar-btn" data-command="formatBlock" data-value="h2" title="Heading">
              H
            </button>
            <button type="button" class="toolbar-btn" data-command="formatBlock" data-value="p" title="Paragraph">
              P
            </button>
          </div>
          <div class="toolbar-separator"></div>
          <div class="toolbar-group">
            <button type="button" class="toolbar-btn" data-command="undo" title="Undo (Ctrl+Z)">
              ↶
            </button>
            <button type="button" class="toolbar-btn" data-command="redo" title="Redo (Ctrl+Y)">
              ↷
            </button>
          </div>
          <div class="toolbar-separator"></div>
          <div class="toolbar-group">
            <button type="button" id="clean-formatting-btn" class="toolbar-btn" title="Clean Formatting">
              Clear Format
            </button>
          </div>
        </div>
        <!-- Editor -->
        <div
          id="soap-editor"
          class="soap-editor"
          contenteditable="true"
          spellcheck="true"
        ></div>
        <!-- Character/Word Count -->
        <div class="editor-stats">
          <span id="word-count">0 words</span>
          <span class="separator">•</span>
          <span id="char-count">0 characters</span>
        </div>
        <div class="button-group">
          <button id="regenerate-soap-btn" class="btn btn-secondary">
            Regenerate
          </button>
          <button id="copy-soap-btn" class="btn btn-success">
            Copy as HTML
          </button>
          <button id="save-soap-btn" class="btn btn-secondary">
            Save
          </button>
        </div>
      </div>
    </section>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Settings</h2>
          <button id="close-settings-btn" class="btn-close" aria-label="Close settings">×</button>
        </div>
        <div class="modal-body">
          <!-- API Key -->
          <div class="form-group">
            <label for="api-key-input">Gemini API Key</label>
            <div class="input-with-button">
              <input
                type="password"
                id="api-key-input"
                class="input-field"
                placeholder="Enter your Gemini API key"
              />
              <button id="test-api-key-btn" class="btn btn-small">Test</button>
            </div>
            <p class="help-text">
              Get your API key from <a href="https://aistudio.google.com/apikey" target="_blank">Google AI Studio</a>
            </p>
          </div>

          <!-- Model Selection -->
          <div class="form-group">
            <label for="model-select">Model</label>
            <select id="model-select" class="input-field">
              <option value="gemini-2.5-flash">Gemini 2.5 Flash (Recommended)</option>
              <option value="gemini-2.5-pro">Gemini 2.5 Pro (More expensive, "smarter")</option>
            </select>
          </div>

          <!-- System Prompt -->
          <div class="form-group">
            <label for="system-prompt-input">System Prompt for SOAP Generation</label>
            <textarea
              id="system-prompt-input"
              class="input-field"
              rows="8"
            ></textarea>
            <button id="reset-prompt-btn" class="btn btn-small">Reset to Default</button>
          </div>

          <!-- Data Management -->
          <div class="form-group">
            <label>Data Management</label>
            <button id="clear-session-btn" class="btn btn-danger btn-small">Clear Current Session</button>
            <button id="clear-all-btn" class="btn btn-danger btn-small">Clear All Data</button>
          </div>
        </div>
        <div class="modal-footer">
          <button id="save-settings-btn" class="btn btn-primary">Save Settings</button>
        </div>
      </div>
    </div>
  </div>

  <script src="js/app.js"></script>
</body>

</html>
